### การวิเคราะห์โจทย์

โจทย์นี้เกี่ยวข้องกับการคำนวณจำนวนแผ่นไม้แนวนอนที่ต้องใช้ในการสร้างชิ้นงานประติมากรรม โดยรับข้อมูลความสูงของชิ้นงานตามตำแหน่งต่างๆ และคำนวณจำนวนแผ่นไม้ที่มีความยาวต่างๆ กันเพื่อสร้างชิ้นงานนั้น โจทย์มีข้อกำหนดดังนี้:

1. **ข้อมูลนำเข้า**:
   - บรรทัดแรก: จำนวนเต็ม `M` (1 ≤ M ≤ 100,000) ซึ่งคือความยาวของฐาน
   - อีก `M` บรรทัด: ความสูงที่ตำแหน่งต่างๆ (จำนวนเต็ม ไม่ติดลบ)

2. **ข้อจำกัด**:
   - ความสูงที่ตำแหน่งติดกันต้องไม่ต่างกันเกิน 5 หน่วย
   - ความสูงสูงสุดของชิ้นงานไม่เกิน 500,000 หน่วย
   - ความสูงที่ตำแหน่งแรกและสุดท้ายไม่เกิน 5 หน่วย

3. **การสร้างชิ้นงาน**:
   - ใช้แผ่นไม้แนวนอนความหนา 1 หน่วย วางซ้อนกัน
   - ความยาวของแผ่นไม้คือจำนวนตำแหน่งที่ต่อเนื่องกันที่มีความสูงครอบคลุมแผ่นไม้นั้น

4. **ข้อมูลส่งออก**:
   - บรรทัดแรก: จำนวนเต็ม `K` (จำนวนความยาวที่แตกต่างกันของแผ่นไม้)
   - อีก `K` บรรทัด: ความยาวของแผ่นไม้ (`A`) และจำนวนแผ่นไม้ที่ใช้ (`B`) เรียงจากความยาวน้อยไปมาก

### ขั้นตอนการคิด

1. **การแทนชิ้นงาน**:
   - คิดชิ้นงานเป็นตาราง 2 มิติ โดยแกน X คือตำแหน่ง (1 ถึง M) และแกน Y คือความสูง (0 ถึงความสูงสูงสุด)
   - แต่ละช่องในตารางระบุว่ามีแผ่นไม้ครอบคลุมหรือไม่

2. **การคำนวณแผ่นไม้**:
   - ที่ระดับความสูงแต่ละหน่วย (ตั้งแต่ 1 ถึงความสูงสูงสุด):
     - ตรวจสอบตำแหน่งที่ความสูงของชิ้นงานครอบคลุมระดับนั้น
     - นับความยาวของช่วงที่ต่อเนื่องกัน (จำนวนตำแหน่งติดต่อกันที่มีความสูงครอบคลุม)
     - บันทึกจำนวนแผ่นไม้ที่มีความยาวนั้น

3. **การนับความยาวต่อเนื่อง**:
   - ใช้ตัวนับเพื่อนับตำแหน่งที่ต่อเนื่องกันที่มีความสูง ≥ ระดับความสูงที่กำลังพิจารณา
   - เมื่อเจอตำแหน่งที่ความสูง < ระดับที่พิจารณา หรือถึงจุดสิ้นสุด ให้บันทึกความยาวที่ได้

4. **การจัดเก็บผลลัพธ์**:
   - ใช้โครงสร้างข้อมูล เช่น `map` หรืออาร์เรย์ เพื่อเก็บจำนวนแผ่นไม้ที่ความยาวต่างๆ
   - แสดงผลตามลำดับความยาวจากน้อยไปมาก

### การออกแบบโปรแกรม (C++)

```cpp
#include <iostream>
#include <vector>
#include <map>
using namespace std;

int main() {
    int M;
    cin >> M; // รับความยาวของฐาน

    vector<int> height(M); // อาร์เรย์เก็บความสูงที่แต่ละตำแหน่ง
    int maxHeight = 0; // หาความสูงสูงสุด
    for (int i = 0; i < M; i++) {
        cin >> height[i];
        if (height[i] > maxHeight) {
            maxHeight = height[i];
        }
    }

    // ใช้ map เพื่อเก็บจำนวนแผ่นไม้ที่ความยาวต่างๆ
    map<int, int> plankCount; // key = ความยาว, value = จำนวน

    // วนลูปตามระดับความสูงตั้งแต่ 1 ถึง maxHeight
    for (int h = 1; h <= maxHeight; h++) {
        int len = 0; // ตัวนับความยาวของแผ่นไม้
        for (int i = 0; i < M; i++) {
            if (height[i] >= h) {
                len++; // เพิ่มความยาวถ้าตำแหน่งนี้ครอบคลุมระดับ h
            } else {
                if (len > 0) {
                    plankCount[len]++; // บันทึกจำนวนแผ่นไม้เมื่อเจอจุดสิ้นสุด
                    len = 0; // รีเซ็ตตัวนับ
                }
            }
        }
        if (len > 0) {
            plankCount[len]++; // บันทึกความยาวสุดท้ายถ้ามี
        }
    }

    // แสดงผลลัพธ์
    cout << plankCount.size() << endl; // จำนวนความยาวที่แตกต่างกัน
    for (auto it = plankCount.begin(); it != plankCount.end(); it++) {
        cout << it->first << " " << it->second << endl; // ความยาวและจำนวน
    }

    return 0;
}
```

### อธิบายโค้ดทีละส่วน

1. **การรวมไลบรารีและเนมสเปซ**:
   ```cpp
   #include <iostream>
   #include <vector>
   #include <map>
   using namespace std;
   ```
   - `iostream`: สำหรับการรับเข้าและส่งออกข้อมูล
   - `vector`: เก็บความสูงที่แต่ละตำแหน่ง
   - `map`: เก็บจำนวนแผ่นไม้ที่ความยาวต่างๆ (เรียงลำดับอัตโนมัติ)
   - `using namespace std`: เพื่อให้ไม่ต้องระบุ `std::` ทุกครั้ง

2. **การรับข้อมูลนำเข้า**:
   ```cpp
   int M;
   cin >> M;
   vector<int> height(M);
   int maxHeight = 0;
   for (int i = 0; i < M; i++) {
       cin >> height[i];
       if (height[i] > maxHeight) {
           maxHeight = height[i];
       }
   }
   ```
   - รับ `M` ซึ่งคือความยาวของฐาน
   - สร้าง `vector` ขนาด `M` เพื่อเก็บความสูง
   - วนลูปรับความสูงที่แต่ละตำแหน่ง และหาความสูงสูงสุด (`maxHeight`)

3. **การคำนวณแผ่นไม้**:
   ```cpp
   map<int, int> plankCount;
   for (int h = 1; h <= maxHeight; h++) {
       int len = 0;
       for (int i = 0; i < M; i++) {
           if (height[i] >= h) {
               len++;
           } else {
               if (len > 0) {
                   plankCount[len]++;
                   len = 0;
               }
           }
       }
       if (len > 0) {
           plankCount[len]++;
       }
   }
   ```
   - ใช้ `map` เพื่อเก็บจำนวนแผ่นไม้ (`plankCount`)
   - วนลูปตามระดับความสูง `h` ตั้งแต่ 1 ถึง `maxHeight`
   - วนลูปตามตำแหน่งใน `height`:
     - ถ้าความสูง ≥ `h` เพิ่มตัวนับความยาว (`len`)
     - ถ้าความสูง < `h` และ `len` > 0 บันทึกจำนวนแผ่นไม้ที่ความยาว `len` แล้วรีเซ็ต `len`
   - หลังจบลูปตำแหน่ง ถ้า `len` > 0 บันทึกความยาวสุดท้าย

4. **การแสดงผลลัพธ์**:
   ```cpp
   cout << plankCount.size() << endl;
   for (auto it = plankCount.begin(); it != plankCount.end(); it++) {
       cout << it->first << " " << it->second << endl;
   }
   ```
   - แสดง `plankCount.size()` ซึ่งคือจำนวนความยาวที่แตกต่างกัน
   - วนลูปผ่าน `map` เพื่อแสดงความยาว (`it->first`) และจำนวน (`it->second`)
   - `map` จะเรียงลำดับความยาวจากน้อยไปมากโดยอัตโนมัติ

### ตัวอย่างการทำงาน

#### Input:
```
9
1
2
4
2
0
3
3
1
2
```

#### การประมวลผล:
- ความสูง: `[1, 2, 4, 2, 0, 3, 3, 1, 2]`
- `maxHeight = 4`

1. **ระดับ h = 1**:
   - `[1, 2, 4, 2, 0, 3, 3, 1, 2]` → `[1, 1, 1, 1, 0, 1, 1, 1, 1]`
   - ความยาวต่อเนื่อง: 4 (ตำแหน่ง 1-4), 4 (ตำแหน่ง 6-9)
   - `plankCount[4] = 2`

2. **ระดับ h = 2**:
   - `[1, 2, 4, 2, 0, 3, 3, 1, 2]` → `[0, 1, 1, 1, 0, 1, 1, 0, 1]`
   - ความยาวต่อเนื่อง: 3 (ตำแหน่ง 2-4), 2 (ตำแหน่ง 6-7), 1 (ตำแหน่ง 9)
   - `plankCount[3] = 1`, `plankCount[2] = 1`, `plankCount[1] = 1`

3. **ระดับ h = 3**:
   - `[1, 2, 4, 2, 0, 3, 3, 1, 2]` → `[0, 0, 1, 0, 0, 1, 1, 0, 0]`
   - ความยาวต่อเนื่อง: 1 (ตำแหน่ง 3), 2 (ตำแหน่ง 6-7)
   - `plankCount[1] = 2`, `plankCount[2] = 2`

4. **ระดับ h = 4**:
   - `[1, 2, 4, 2, 0, 3, 3, 1, 2]` → `[0, 0, 1, 0, 0, 0, 0, 0, 0]`
   - ความยาวต่อเนื่อง: 1 (ตำแหน่ง 3)
   - `plankCount[1] = 3`

#### ผลลัพธ์:
- `plankCount`: `{1: 3, 2: 2, 3: 1, 4: 2}`
- Output:
```
4
1 3
2 2
3 1
4 2
```

### ข้อสรุป
โปรแกรมนี้สามารถคำนวณจำนวนแผ่นไม้ที่ความยาวต่างๆ ได้อย่างถูกต้องตามโจทย์ โดยใช้โครงสร้างข้อมูล `vector` และ `map` เพื่อจัดการข้อมูลและเรียงลำดับผลลัพธ์ การวนลูปตามระดับความสูงและตำแหน่งช่วยให้สามารถนับความยาวของแผ่นไม้ได้อย่างแม่นยำ โค้ดนี้มีประสิทธิภาพเพียงพอสำหรับ `M` สูงสุด 100,000 และความสูงสูงสุด 500,000 ตามที่โจทย์กำหนด